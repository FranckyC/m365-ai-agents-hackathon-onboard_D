"use strict";(self.webpackChunkonboard_d_docs=self.webpackChunkonboard_d_docs||[]).push([[116],{972:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/openai_deployments-520c794df3c4352ed0bf6c2819778485.png"},1682:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/power_automate_outcome-7e458e1568517867e9c5f62407510d63.png"},2914:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>y,contentTitle:()=>w,default:()=>_,frontMatter:()=>b,metadata:()=>s,toc:()=>v});const s=JSON.parse('{"id":"setup-environment","title":"Setup the environment","description":"The \\"Onboard_D\\" agent requires both Microsoft 365 and Azure environments to be configured to work properly. Before using it, there is some setup to do.","source":"@site/docs/2-setup-environment.mdx","sourceDirName":".","slug":"/setup-environment","permalink":"/m365-ai-agents-hackathon-onboard_D/setup-environment","draft":false,"unlisted":false,"editUrl":"https://github.com/FranckyC/m365-ai-agents-hackathon-onboard_D/docs/2-setup-environment.mdx","tags":[],"version":"current","lastUpdatedBy":"Franck Cornu","lastUpdatedAt":1745944020000,"sidebarPosition":2,"frontMatter":{"toc_min_heading_level":2,"toc_max_heading_level":5},"sidebar":"mainSidebar","previous":{"title":"Meet Onboard_D, your HR onboading coach!","permalink":"/m365-ai-agents-hackathon-onboard_D/"},"next":{"title":"Minimal path to awesome","permalink":"/m365-ai-agents-hackathon-onboard_D/agent-testing"}}');var r=t(4848),a=t(8453);const i=t.p+"assets/images/openai_settings-b7f4a0c78948f31d9b976c3aa59d663d.png",o=t.p+"assets/images/azureai_search_vectorizer-517c640df49e20a78d92677cf8404007.png",l=t.p+"assets/images/azure_ai_search_keys-addae81df69d55551cadcbf9430876fa.png",c=(t.p,t.p+"assets/images/hr_contoso_team-5aab162f23aa67ab8ef496c4dc6aade4.png"),d=t.p+"assets/images/add_plan_to_team-e180de4c2426565e1075b1104817c1b2.png",h=t.p+"assets/images/sample_hr_plan-a1469e0503bddf33d6e919ec122bd306.png",p=t.p+"assets/images/upload_dummy_documents-2cb62cd811c2da1bf3d301b98845c241.png",u=t.p+"assets/images/add_references_to_task-6d3686264bdb02bd60222da5b80b3ef8.png",m=t.p+"assets/images/copy_file_path-f533b52f144dc748b3ca83715b8092ad.png",x=(t.p,t.p+"assets/images/add_logic_app-d756eb6d62d46a5753613d89b20445e7.png"),j=t.p+"assets/images/logic_app_params-e78c5d09327062e106660a4d252aaaa5.png",g=t.p+"assets/images/logic_app_connections-c2ae9d7503a1a4f55ec8cac2b8fb3cd1.png",f=t.p+"assets/images/search_instance_url-f50d36676c51f065ac307c4fd19ae073.png",b={toc_min_heading_level:2,toc_max_heading_level:5},w="Setup the environment",y={},v=[{value:"Clone the GitHub repository",id:"clone-the-github-repository",level:2},{value:"Create a new team in Teams",id:"create-a-new-team-in-teams",level:2},{value:"Setup Azure environment",id:"setup-azure-environment",level:2},{value:"1. Create a new Entra ID application",id:"1-create-a-new-entra-id-application",level:3},{value:"2. Create Azure resources",id:"2-create-azure-resources",level:3},{value:"Create a new resource group",id:"create-a-new-resource-group",level:4},{value:"Create a new Azure OpenAI resource",id:"create-a-new-azure-openai-resource",level:4},{value:"Create a new storage account",id:"create-a-new-storage-account",level:4},{value:"Create Azure AI Search",id:"create-azure-ai-search",level:4},{value:"Create the Logic App to index documents",id:"create-the-logic-app-to-index-documents",level:4},{value:"Finalize setup for the Microsoft 365 environment",id:"finalize-setup-for-the-microsoft-365-environment",level:2},{value:"1. Create the employees onboarding list",id:"1-create-the-employees-onboarding-list",level:3},{value:"2. Create a HR Onboarding template plan",id:"2-create-a-hr-onboarding-template-plan",level:3},{value:"3. Import Power Automate flows",id:"3-import-power-automate-flows",level:3},{value:"4. Link documents to task",id:"4-link-documents-to-task",level:3}];function A(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"setup-the-environment",children:"Setup the environment"})}),"\n",(0,r.jsx)(n.p,{children:'The "Onboard_D" agent requires both Microsoft 365 and Azure environments to be configured to work properly. Before using it, there is some setup to do.'}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsx)(n.p,{children:"For the purpose of the hackathon demo, the deployment and preparation is done manually. However, in a proper production scenario, all these steps would be automated."}),(0,r.jsxs)(n.p,{children:["\u23f1\ufe0f",(0,r.jsx)(n.strong,{children:"Time required: 20 to 30 min (sorry for that, but good news, that is pretty straightforward)"})]})]}),"\n",(0,r.jsx)(n.h2,{id:"clone-the-github-repository",children:"Clone the GitHub repository"}),"\n",(0,r.jsxs)(n.p,{children:["First, clone the GitHub repository from ",(0,r.jsx)(n.a,{href:"https://github.com/FranckyC/m365-ai-agents-hackathon-onboard_D",children:"https://github.com/FranckyC/m365-ai-agents-hackathon-onboard_D"})]}),"\n",(0,r.jsx)(n.h2,{id:"create-a-new-team-in-teams",children:"Create a new team in Teams"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Create a new Team ",(0,r.jsx)(n.strong,{children:"Contoso HR Onboarding Management"})," in Microsoft Teams with default ",(0,r.jsx)(n.em,{children:"Employee onboarding"})," channel:"]}),"\n"]}),"\n",(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("img",{className:"w-[50%]",src:c})}),"\n",(0,r.jsx)(n.h2,{id:"setup-azure-environment",children:"Setup Azure environment"}),"\n",(0,r.jsx)(n.h3,{id:"1-create-a-new-entra-id-application",children:"1. Create a new Entra ID application"}),"\n",(0,r.jsx)(n.p,{children:"To consume the Microsoft Graph API to access Microsoft Planner and SharePoint data, you'll need to register a dedicated Entra ID application."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Once created, generate a client secret. This one will be used in the agent configuration in the ",(0,r.jsx)(n.code,{children:"SECRET_AAD_APP_CLIENT_SECRET"})," variable (",(0,r.jsx)(n.code,{children:"env/env.local.user"})," file)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"&quot;Entra ID application&quot;",src:t(5027).A+"",width:"1437",height:"752"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Configure API permissions in the app. The following API permissions are used by the application."}),"\n"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"API permission"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Used for"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Tasks.ReadWrite"})}),(0,r.jsx)(n.td,{children:"Delegated"}),(0,r.jsx)(n.td,{children:"Get and updates Planner tasks on behalf of the user."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Sites.Read.All"})}),(0,r.jsx)(n.td,{children:"Delegated"}),(0,r.jsxs)(n.td,{children:["Get associated plan ID for the user. Could be restricted to ",(0,r.jsx)(n.code,{children:"Lists.SelectedOperations.Selected"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Tasks.ReadWrite.All"})}),(0,r.jsx)(n.td,{children:"Application"}),(0,r.jsxs)(n.td,{children:["Get tasks for a user when notified automatically + Run the ",(0,r.jsx)(n.code,{children:"import-tasks.ps1"})," script to provision sample plan."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Sites.Read.All"})}),(0,r.jsx)(n.td,{children:"Application"}),(0,r.jsxs)(n.td,{children:["Get associated plan ID for the user. Could be restricted to ",(0,r.jsx)(n.code,{children:"Lists.SelectedOperations.Selected"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Group.Read.All"})}),(0,r.jsx)(n.td,{children:"Application"}),(0,r.jsxs)(n.td,{children:["Run the ",(0,r.jsx)(n.code,{children:"import-tasks.ps1"})," script to provision sample plan."]})]})]})]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"Don't forget to grant admin consent."})}),"\n",(0,r.jsx)(n.h3,{id:"2-create-azure-resources",children:"2. Create Azure resources"}),"\n",(0,r.jsx)(n.h4,{id:"create-a-new-resource-group",children:"Create a new resource group"}),"\n",(0,r.jsx)(n.p,{children:"Create a new Azure resource group."}),"\n",(0,r.jsx)(n.admonition,{title:"Azure Region",type:"note",children:(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.strong,{children:"North Central US"})," region for resources for the purpose of the demo."]})}),"\n",(0,r.jsx)(n.h4,{id:"create-a-new-azure-openai-resource",children:"Create a new Azure OpenAI resource"}),"\n",(0,r.jsx)(n.p,{children:"Once created, go to the Azure AI Foundry portal and create the following model deployments (use default model names for deployment names):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"gpt-4o-mini"}),". This model is used by the agent to answer user questions."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"text-embedding-3-large"}),". This model is used to generate embeddings for Azure AI Search indexing."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"&quot;OpenAI deployments&quot;",src:t(972).A+"",width:"1264",height:"545"})}),"\n",(0,r.jsx)(n.p,{children:"Open any deployment and copy the following values information:"}),"\n",(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("img",{className:"w-[60%]",src:i})}),"\n",(0,r.jsxs)(n.p,{children:["They will be used later in the agent source code respectively in the ",(0,r.jsx)(n.code,{children:".env.local.user"})," (",(0,r.jsx)(n.code,{children:"SECRET_AZURE_OPENAI_API_KEY"})," variable) and ",(0,r.jsx)(n.code,{children:"env.local"})," files (",(0,r.jsx)(n.code,{children:"AZURE_OPENAI_ENDPOINT"})," variable)"]}),"\n",(0,r.jsx)(n.h4,{id:"create-a-new-storage-account",children:"Create a new storage account"}),"\n",(0,r.jsx)(n.p,{children:"We use a blob container to store the bot state (i.e. user conversation) to be able to send targeted notifications (Use 'Azure Blob Storage or Azure Data Lake Storage Gen 2' as primary service + LRS redundancy)."}),"\n",(0,r.jsxs)(n.p,{children:["Once storage account create, from the storage settings, copy the connection string. It will be used in the ",(0,r.jsx)(n.code,{children:".env.local.user"})," file as ",(0,r.jsx)(n.code,{children:"SECRET_BLOB_CONNECTION_STRING"})," variable."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"&quot;Storage account&quot;",src:t(3974).A+"",width:"1485",height:"822"})}),"\n",(0,r.jsx)(n.h4,{id:"create-azure-ai-search",children:"Create Azure AI Search"}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:"Use the F0 pricing tiers for demo purpose."})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Create a new index ",(0,r.jsx)(n.strong,{children:"hrdocuments-index"})," with following schema:"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"&quot;Azure AI Search index schema&quot;",src:t(5539).A+"",width:"1427",height:"366"})}),"\n",(0,r.jsx)(n.admonition,{title:"Search schema fields",type:"warning",children:(0,r.jsxs)(n.p,{children:["Pay attention to the fields properties (i.e. retrievable, searchable, etc.), especially for the ",(0,r.jsx)(n.code,{children:"content"})," property). Once the index is created you can't change those unless your delete and recreate the index."]})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["For the ",(0,r.jsx)(n.strong,{children:"embeddings"})," field (Collection(Edm.Single)), create a new vector profile using default settings. For the vectorizer, use the Azure OpenAI resource created earlier with API key access and the ",(0,r.jsx)(n.code,{children:"text-embedding-3-large"})," model:"]}),"\n"]}),"\n",(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("img",{className:"w-[30%]",src:o})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Do not create compression configuration."}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Finally, copy the API Key value from the ",(0,r.jsx)(n.strong,{children:"Keys"})," settings. This value will be used in the ",(0,r.jsx)(n.code,{children:".env.local.user"})," file as ",(0,r.jsx)(n.code,{children:"SECRET_AZURE_SEARCH_API_KEY"})," variable."]}),"\n"]}),"\n",(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("img",{className:"w-[50%]",src:l})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Copy also the search instance URL. It will be used in the ",(0,r.jsx)(n.code,{children:"AZSEARCH_ENDPOINT"})," variable."]}),"\n"]}),"\n",(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("img",{className:"w-[50%]",src:f})}),"\n",(0,r.jsx)(n.h4,{id:"create-the-logic-app-to-index-documents",children:"Create the Logic App to index documents"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Create a new Logic App with ",(0,r.jsx)(n.em,{children:'"Workflow Service Plan"'}),". Use ",(0,r.jsx)(n.strong,{children:"North Central US"})," for the region."]}),"\n",(0,r.jsxs)(n.li,{children:["On the ",(0,r.jsx)(n.em,{children:'"Workflows"'})," section, add a new workflow from template. Search for ",(0,r.jsx)(n.em,{children:"'Azure AI Search'"})," and choose ",(0,r.jsx)(n.strong,{children:"SharePoint Online: Ingest and index files using Azure OpenAI and Azure AI Search - RAG pattern"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Give the workflow a name and leave the ",(0,r.jsx)(n.em,{children:"'Stateful'"})," state type."]}),"\n",(0,r.jsx)(n.li,{children:"Configure the connections according to resources created earlier (Azure AI Search via API Key, Azure Open by API Key and SharePoint Online):"}),"\n"]}),"\n",(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("img",{className:"w-[70%]",src:g})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Fill the parameters for the template as follow:"}),"\n"]}),"\n",(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("img",{className:"w-[70%]",src:j})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Once the workflow created, open the designer and update the ",(0,r.jsx)(n.em,{children:'"Select embeddings and map to AI Search schema"'})," action to add a new property ",(0,r.jsx)(n.strong,{children:"'url'"}),". Use the formula ",(0,r.jsx)(n.code,{children:"triggerBody()?['{Link}']"})," as value:"]}),"\n"]}),"\n",(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("img",{className:"w-[70%]",src:x})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Save the workflow."}),"\n",(0,r.jsxs)(n.li,{children:["In the 'Documents' library of the SharePoint site , upload the two sample documents provided from the folder ",(0,r.jsx)(n.code,{children:"deploy/data"}),". If your Logic App is correctly configured, documents should be indexed in Azure AI Search automatically when added."]}),"\n"]}),"\n",(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("img",{className:"w-[70%]",src:p})}),"\n",(0,r.jsx)(n.h2,{id:"finalize-setup-for-the-microsoft-365-environment",children:"Finalize setup for the Microsoft 365 environment"}),"\n",(0,r.jsx)(n.h3,{id:"1-create-the-employees-onboarding-list",children:"1. Create the employees onboarding list"}),"\n",(0,r.jsxs)(n.p,{children:["In the SharePoint site associated to this team, create a new SharePoint list ",(0,r.jsx)(n.code,{children:"Employees Onboarding"})," with the following columns (",(0,r.jsx)(n.strong,{children:"internal names are important here as they will be referenced in the agent code"}),"):"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Column internal name"}),(0,r.jsx)(n.th,{children:"Display name"}),(0,r.jsx)(n.th,{children:"Type"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"contosoEmployeeName"})}),(0,r.jsx)(n.td,{children:"Employee Name"}),(0,r.jsx)(n.td,{children:"Person or Group"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"contosoEmployeeStartDate"})}),(0,r.jsx)(n.td,{children:"Employee Start Date"}),(0,r.jsx)(n.td,{children:"Date"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"contosoEmployeePlanId"})}),(0,r.jsx)(n.td,{children:"Employee Plan ID"}),(0,r.jsx)(n.td,{children:"Text"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"contosoEmployeedAadObjectId"})}),(0,r.jsx)(n.td,{children:"Employee AAD ID"}),(0,r.jsx)(n.td,{children:"Text"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"&quot;Employee Onboarding list&quot;",src:t(5997).A+"",width:"1836",height:"595"})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"In SharePoint, column internal names are set at column creation. Once set, you are free to rename the column with a friendly name"})}),"\n",(0,r.jsx)(n.h3,{id:"2-create-a-hr-onboarding-template-plan",children:"2. Create a HR Onboarding template plan"}),"\n",(0,r.jsxs)(n.p,{children:["Use the ",(0,r.jsx)(n.code,{children:"deploy/import-tasks.ps1"})," script to automatically import a sample Microsoft Planner onboarding plan in the Microsoft 365 group:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'Install-Module Microsoft.Graph.Planner -Scope CurrentUser -Repository PSGallery -Force          \n\n$ClientId="{Client ID of the Entra ID app}"\n$TenantId="{Tenant ID}"\n$ClientSecret="{Client Secret of the Entra ID app}"\n$GroupId="{ID if the Microsoft 365 group}"\n\n.\\import-tasks1.ps1 -clientID $ClientId -tenantID $TenantId -clientSecret $ClientSecret -csvfilepath "./data/tasks.csv" -PlanName "Contoso Employee Onboarding Plan" -GroupID $GroupId\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"You should be owner of the group to run that command."}),"\n",(0,r.jsxs)(n.li,{children:["Use the information from the Entra ID application created earlier (",(0,r.jsx)(n.code,{children:"ClientId"}),",",(0,r.jsx)(n.code,{children:"ClientSecret"}),",",(0,r.jsx)(n.code,{children:"TenantId"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["You can get tehh group ID by search the group name in Entra ID:\n",(0,r.jsx)(n.img,{alt:"&quot;Group ID&quot;",src:t(3192).A+"",width:"1502",height:"571"})]}),"\n"]})}),"\n",(0,r.jsx)(n.p,{children:"After the script completed, you can then add the plan to the team as a new tab:"}),"\n",(0,r.jsxs)("div",{className:"flex flex-col space-y-4 items-center justify-center",children:[(0,r.jsx)("img",{className:"w-[50%]",src:d}),(0,r.jsx)("img",{className:"w-[80%]",src:h})]}),"\n",(0,r.jsx)(n.h3,{id:"3-import-power-automate-flows",children:"3. Import Power Automate flows"}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"For the purpose of this solution, and to make the deployment easier, we used Power uatomate with Premium connectors (i.e. HTTP)."})}),"\n",(0,r.jsx)(n.p,{children:"The Power Automate flow for new employee configuration is deployed as a Power Platform solution."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Go to ",(0,r.jsx)(n.a,{href:"https://make.powerautomate.com/",children:"https://make.powerautomate.com/"}),", choose the environment you want to use and then go to 'Solutions'."]}),"\n",(0,r.jsxs)(n.li,{children:["Import the ",(0,r.jsx)(n.code,{children:"deploy/onboard_dNewEmployeeSetup.zip"})," solution file and click 'Next' (let ",(0,r.jsx)(n.em,{children:"'Enable Plugin steps and flows included in the solution'"})," option enabled)."]}),"\n",(0,r.jsxs)(n.li,{children:["Select ",(0,r.jsx)(n.em,{children:'"Review and adjust all connections"'})," and configure connections according to your environment (SharePoint, Planner and Office 365)."]}),"\n",(0,r.jsx)(n.li,{children:"Fill the workflow paramaters according to your environment:"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"&quot;Power Automate paramters&quot;",src:t(6904).A+"",width:"1033",height:"1054"})}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["The Plan ID can be rereived directly from the URL when, from teh Team tab you select ",(0,r.jsx)(n.em,{children:'"Open in new window"'}),":\n",(0,r.jsx)(n.img,{alt:"&quot;Planner ID&quot;",src:t(6613).A+"",width:"1214",height:"51"}),"\nLeave the ",(0,r.jsx)(n.em,{children:"'Notifications endpoint'"})," parameter untouched for now. This URL will be replaced by a DevTunnels temporary URL when testing the agent."]})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"Test the Power Automate by adding a new entry in the list for your account (employee name + start date, leave other fields blank). You should see the plan ID and AAD ID values populated automatically by the flow."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"&quot;Power Automate results&quot;",src:t(1682).A+"",width:"1538",height:"218"})}),"\n",(0,r.jsx)(n.h3,{id:"4-link-documents-to-task",children:"4. Link documents to task"}),"\n",(0,r.jsx)(n.p,{children:"To test the cross references retrieval from the agent using mutliple tools, you can link specific documents to a task. This way, the content of these documents will be considered when providing a summay of task to the user."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["In Microsoft Planner. go to the plan newly created for the user and link the ",(0,r.jsx)(n.em,{children:"Contoso Electronics PerksPlus Program.docx"})," file to the 'Review company policies' task:"]}),"\n"]}),"\n",(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("img",{className:"w-[70%]",src:u})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsx)(n.p,{children:"To get the absolute path of a file in a SharePoint library, select the document item, open the 'Details' pane and copy the value:"}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("img",{className:"w-[40%]",src:m})})]}),"\n",(0,r.jsxs)(n.p,{children:["You are now ready to ",(0,r.jsx)(n.a,{href:"./agent-testing",children:"test the agent locally from Visual Studio Code and Teams Toolkit"}),"!cd"]})]})}function _(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(A,{...e})}):A(e)}},3192:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/group_id-604223d7f99d8b5daf58eeb048c56ff2.png"},3974:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/storage_connectionstring-b601556cab42d94f59234d745908b3a3.png"},5027:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/entra_id_app-bdaf4bb0d611f51697b553b4780d56ee.png"},5539:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/azureai_search_schema-4646bf4544b333c299216f7e72efa295.png"},5997:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/employee_splist_columns-3f9e14294737be8a086cbdbbc8299233.png"},6613:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/planner_id_url-07458d31eff839bb2ca2d0c6099327ab.png"},6904:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/power_automate_parameters-0aca1fbd32d455b720b88ac85649a628.png"},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var s=t(6540);const r={},a=s.createContext(r);function i(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);