<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-setup-environment" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Setup the environment | Onboard_D AI Agent Solution</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost:3000/m365-ai-agents-hackathon-onboard_D/setup-environment"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Setup the environment | Onboard_D AI Agent Solution"><meta data-rh="true" name="description" content="The &quot;Onboard_D&quot; agent requires both Microsoft 365 and Azure environments to be configured to work properly. Before using it, there is some setup to do."><meta data-rh="true" property="og:description" content="The &quot;Onboard_D&quot; agent requires both Microsoft 365 and Azure environments to be configured to work properly. Before using it, there is some setup to do."><link data-rh="true" rel="icon" href="/m365-ai-agents-hackathon-onboard_D/img/favicon.ico"><link data-rh="true" rel="canonical" href="http://localhost:3000/m365-ai-agents-hackathon-onboard_D/setup-environment"><link data-rh="true" rel="alternate" href="http://localhost:3000/m365-ai-agents-hackathon-onboard_D/setup-environment" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost:3000/m365-ai-agents-hackathon-onboard_D/setup-environment" hreflang="x-default"><link rel="stylesheet" href="/m365-ai-agents-hackathon-onboard_D/assets/css/styles.fed2febf.css">
<script src="/m365-ai-agents-hackathon-onboard_D/assets/js/runtime~main.5cbe818b.js" defer="defer"></script>
<script src="/m365-ai-agents-hackathon-onboard_D/assets/js/main.7624a08f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/m365-ai-agents-hackathon-onboard_D/"><div class="navbar__logo"><img src="/m365-ai-agents-hackathon-onboard_D/img/onboard_d.png" alt="Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/m365-ai-agents-hackathon-onboard_D/img/onboard_d.png" alt="Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Onboard_D AI Agent Solution</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/FranckyC/m365-ai-agents-hackathon-onboard_D" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">
              <a style="display:flex" href="https://github.com/FranckyC/m365-ai-agents-hackathon-onboard_D" target="_blank" rel="noreferrer noopener" aria-label="Components playground">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="31px" viewBox="0 0 31 31" version="1.1">
                  <g id="surface1">
                  <path style="stroke:none;fill-rule:evenodd;fill:rgb(14.117648%,16.078432%,18.431373%);fill-opacity:1;" d="M 15.453125 0 C 6.910156 0 0 7.105469 0 15.894531 C 0 22.917969 4.425781 28.863281 10.566406 30.96875 C 11.335938 31.128906 11.617188 30.628906 11.617188 30.207031 C 11.617188 29.839844 11.589844 28.574219 11.589844 27.261719 C 7.292969 28.207031 6.394531 25.367188 6.394531 25.367188 C 5.707031 23.523438 4.683594 23.050781 4.683594 23.050781 C 3.273438 22.078125 4.785156 22.078125 4.785156 22.078125 C 6.34375 22.183594 7.164062 23.707031 7.164062 23.707031 C 8.546875 26.128906 10.773438 25.445312 11.667969 25.023438 C 11.792969 23.996094 12.203125 23.285156 12.640625 22.890625 C 9.210938 22.523438 5.601562 21.15625 5.601562 15.050781 C 5.601562 13.3125 6.21875 11.894531 7.191406 10.789062 C 7.035156 10.394531 6.5 8.761719 7.34375 6.578125 C 7.34375 6.578125 8.648438 6.15625 11.589844 8.210938 C 12.851562 7.863281 14.148438 7.683594 15.453125 7.683594 C 16.757812 7.683594 18.089844 7.867188 19.316406 8.210938 C 22.257812 6.15625 23.5625 6.578125 23.5625 6.578125 C 24.410156 8.761719 23.871094 10.394531 23.71875 10.789062 C 24.714844 11.894531 25.304688 13.3125 25.304688 15.050781 C 25.304688 21.15625 21.695312 22.496094 18.242188 22.890625 C 18.804688 23.390625 19.292969 24.339844 19.292969 25.839844 C 19.292969 27.96875 19.265625 29.679688 19.265625 30.207031 C 19.265625 30.628906 19.546875 31.128906 20.316406 30.96875 C 26.457031 28.863281 30.882812 22.917969 30.882812 15.894531 C 30.90625 7.105469 23.972656 0 15.453125 0 Z M 15.453125 0 "/>
                  </g>
                </svg>
              </a>
            </a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/m365-ai-agents-hackathon-onboard_D/">Meet Onboard_D, your HR onboading coach!</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/m365-ai-agents-hackathon-onboard_D/setup-environment">Setup the environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/m365-ai-agents-hackathon-onboard_D/agent-testing">Minimal path to awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/m365-ai-agents-hackathon-onboard_D/technical-notes">Hackathon notes</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/m365-ai-agents-hackathon-onboard_D/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Setup the environment</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Setup the environment</h1></header>
<p>The &quot;Onboard_D&quot; agent requires both Microsoft 365 and Azure environments to be configured to work properly. Before using it, there is some setup to do.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>For the purpose of the hackathon demo, the deployment and preparation is done manually. However, in a proper production scenario, all these steps would be automated.</p><p>⏱️<strong>Time required: 20 to 30 min (sorry for that, but good news, that is pretty straightforward)</strong></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="clone-the-github-repository">Clone the GitHub repository<a href="#clone-the-github-repository" class="hash-link" aria-label="Direct link to Clone the GitHub repository" title="Direct link to Clone the GitHub repository">​</a></h2>
<p>First, clone the GitHub repository from <a href="https://github.com/FranckyC/m365-ai-agents-hackathon-onboard_D" target="_blank" rel="noopener noreferrer">https://github.com/FranckyC/m365-ai-agents-hackathon-onboard_D</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-new-team-in-teams">Create a new team in Teams<a href="#create-a-new-team-in-teams" class="hash-link" aria-label="Direct link to Create a new team in Teams" title="Direct link to Create a new team in Teams">​</a></h2>
<ul>
<li>Create a new Team <strong>Contoso HR Onboarding Management</strong> in Microsoft Teams with default <em>Employee onboarding</em> channel:</li>
</ul>
<div class="flex justify-center"><img class="w-[50%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/hr_contoso_team-5aab162f23aa67ab8ef496c4dc6aade4.png"></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-azure-environment">Setup Azure environment<a href="#setup-azure-environment" class="hash-link" aria-label="Direct link to Setup Azure environment" title="Direct link to Setup Azure environment">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-create-a-new-entra-id-application">1. Create a new Entra ID application<a href="#1-create-a-new-entra-id-application" class="hash-link" aria-label="Direct link to 1. Create a new Entra ID application" title="Direct link to 1. Create a new Entra ID application">​</a></h3>
<p>To consume the Microsoft Graph API to access Microsoft Planner and SharePoint data, you&#x27;ll need to register a dedicated Entra ID application.</p>
<ul>
<li>Once created, generate a client secret. This one will be used in the agent configuration in the <code>SECRET_AAD_APP_CLIENT_SECRET</code> variable (<code>env/env.local.user</code> file).</li>
</ul>
<p><img decoding="async" loading="lazy" alt="&amp;quot;Entra ID application&amp;quot;" src="/m365-ai-agents-hackathon-onboard_D/assets/images/entra_id_app-bdaf4bb0d611f51697b553b4780d56ee.png" width="1437" height="752" class="img_ev3q"></p>
<ul>
<li>Configure API permissions in the app. The following API permissions are used by the application.</li>
</ul>
<table><thead><tr><th>API permission</th><th>Type</th><th>Used for</th></tr></thead><tbody><tr><td><code>Tasks.ReadWrite</code></td><td>Delegated</td><td>Get and updates Planner tasks on behalf of the user.</td></tr><tr><td><code>Sites.Read.All</code></td><td>Delegated</td><td>Get associated plan ID for the user. Could be restricted to <code>Lists.SelectedOperations.Selected</code>.</td></tr><tr><td><code>Tasks.ReadWrite.All</code></td><td>Application</td><td>Get tasks for a user when notified automatically + Run the <code>import-tasks.ps1</code> script to provision sample plan.</td></tr><tr><td><code>Sites.Read.All</code></td><td>Application</td><td>Get associated plan ID for the user. Could be restricted to <code>Lists.SelectedOperations.Selected</code>.</td></tr><tr><td><code>Group.Read.All</code></td><td>Application</td><td>Run the <code>import-tasks.ps1</code> script to provision sample plan.</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Don&#x27;t forget to grant admin consent.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-create-azure-resources">2. Create Azure resources<a href="#2-create-azure-resources" class="hash-link" aria-label="Direct link to 2. Create Azure resources" title="Direct link to 2. Create Azure resources">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-new-resource-group">Create a new resource group<a href="#create-a-new-resource-group" class="hash-link" aria-label="Direct link to Create a new resource group" title="Direct link to Create a new resource group">​</a></h4>
<p>Create a new Azure resource group.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Azure Region</div><div class="admonitionContent_BuS1"><p>Use <strong>North Central US</strong> region for resources for the purpose of the demo.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-new-azure-openai-resource">Create a new Azure OpenAI resource<a href="#create-a-new-azure-openai-resource" class="hash-link" aria-label="Direct link to Create a new Azure OpenAI resource" title="Direct link to Create a new Azure OpenAI resource">​</a></h4>
<p>Once created, go to the Azure AI Foundry portal and create the following model deployments (use default model names for deployment names):</p>
<ul>
<li><code>gpt-4o-mini</code>. This model is used by the agent to answer user questions.</li>
<li><code>text-embedding-3-large</code>. This model is used to generate embeddings for Azure AI Search indexing.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="&amp;quot;OpenAI deployments&amp;quot;" src="/m365-ai-agents-hackathon-onboard_D/assets/images/openai_deployments-520c794df3c4352ed0bf6c2819778485.png" width="1264" height="545" class="img_ev3q"></p>
<p>Open any deployment and copy the following values information:</p>
<div class="flex justify-center"><img class="w-[60%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/openai_settings-b7f4a0c78948f31d9b976c3aa59d663d.png"></div>
<p>They will be used later in the agent source code respectively in the <code>.env.local.user</code> (<code>SECRET_AZURE_OPENAI_API_KEY</code> variable) and <code>env.local</code> files (<code>AZURE_OPENAI_ENDPOINT</code> variable)</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-new-storage-account">Create a new storage account<a href="#create-a-new-storage-account" class="hash-link" aria-label="Direct link to Create a new storage account" title="Direct link to Create a new storage account">​</a></h4>
<p>We use a blob container to store the bot state (i.e. user conversation) to be able to send targeted notifications (Use &#x27;Azure Blob Storage or Azure Data Lake Storage Gen 2&#x27; as primary service + LRS redundancy).</p>
<p>Once storage account create, from the storage settings, copy the connection string. It will be used in the <code>.env.local.user</code> file as <code>SECRET_BLOB_CONNECTION_STRING</code> variable.</p>
<p><img decoding="async" loading="lazy" alt="&amp;quot;Storage account&amp;quot;" src="/m365-ai-agents-hackathon-onboard_D/assets/images/storage_connectionstring-b601556cab42d94f59234d745908b3a3.png" width="1485" height="822" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-azure-ai-search">Create Azure AI Search<a href="#create-azure-ai-search" class="hash-link" aria-label="Direct link to Create Azure AI Search" title="Direct link to Create Azure AI Search">​</a></h4>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Use the F0 pricing tiers for demo purpose.</p></div></div>
<ul>
<li>Create a new index <strong>hrdocuments-index</strong> with following schema:</li>
</ul>
<p><img decoding="async" loading="lazy" alt="&amp;quot;Azure AI Search index schema&amp;quot;" src="/m365-ai-agents-hackathon-onboard_D/assets/images/azureai_search_schema-4646bf4544b333c299216f7e72efa295.png" width="1427" height="366" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Search schema fields</div><div class="admonitionContent_BuS1"><p>Pay attention to the fields properties (i.e. retrievable, searchable, etc.), especially for the <code>content</code> property). Once the index is created you can&#x27;t change those unless your delete and recreate the index.</p></div></div>
<ul>
<li>For the <strong>embeddings</strong> field (Collection(Edm.Single)), create a new vector profile using default settings. For the vectorizer, use the Azure OpenAI resource created earlier with API key access and the <code>text-embedding-3-large</code> model:</li>
</ul>
<div class="flex justify-center"><img class="w-[30%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/azureai_search_vectorizer-517c640df49e20a78d92677cf8404007.png"></div>
<blockquote>
<p>Do not create compression configuration.</p>
</blockquote>
<ul>
<li>Finally, copy the API Key value from the <strong>Keys</strong> settings. This value will be used in the <code>.env.local.user</code> file as <code>SECRET_AZURE_SEARCH_API_KEY</code> variable.</li>
</ul>
<div class="flex justify-center"><img class="w-[50%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/azure_ai_search_keys-addae81df69d55551cadcbf9430876fa.png"></div>
<ul>
<li>Copy also the search instance URL. It will be used in the <code>AZSEARCH_ENDPOINT</code> variable.</li>
</ul>
<div class="flex justify-center"><img class="w-[50%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/search_instance_url-f50d36676c51f065ac307c4fd19ae073.png"></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-logic-app-to-index-documents">Create the Logic App to index documents<a href="#create-the-logic-app-to-index-documents" class="hash-link" aria-label="Direct link to Create the Logic App to index documents" title="Direct link to Create the Logic App to index documents">​</a></h4>
<ul>
<li>Create a new Logic App with <em>&quot;Workflow Service Plan&quot;</em>. Use <strong>North Central US</strong> for the region.</li>
<li>On the <em>&quot;Workflows&quot;</em> section, add a new workflow from template. Search for <em>&#x27;Azure AI Search&#x27;</em> and choose <strong>SharePoint Online: Ingest and index files using Azure OpenAI and Azure AI Search - RAG pattern</strong>.</li>
<li>Give the workflow a name and leave the <em>&#x27;Stateful&#x27;</em> state type.</li>
<li>Configure the connections according to resources created earlier (Azure AI Search via API Key, Azure Open by API Key and SharePoint Online):</li>
</ul>
<div class="flex justify-center"><img class="w-[70%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/logic_app_connections-c2ae9d7503a1a4f55ec8cac2b8fb3cd1.png"></div>
<ul>
<li>Fill the parameters for the template as follow:</li>
</ul>
<div class="flex justify-center"><img class="w-[70%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/logic_app_params-e78c5d09327062e106660a4d252aaaa5.png"></div>
<ul>
<li>Once the workflow created, open the designer and update the <em>&quot;Select embeddings and map to AI Search schema&quot;</em> action to add a new property <strong>&#x27;url&#x27;</strong>. Use the formula <code>triggerBody()?[&#x27;{Link}&#x27;]</code> as value:</li>
</ul>
<div class="flex justify-center"><img class="w-[70%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/add_logic_app-d756eb6d62d46a5753613d89b20445e7.png"></div>
<ul>
<li>Save the workflow.</li>
<li>In the &#x27;Documents&#x27; library of the SharePoint site , upload the two sample documents provided from the folder <code>deploy/data</code>. If your Logic App is correctly configured, documents should be indexed in Azure AI Search automatically when added.</li>
</ul>
<div class="flex justify-center"><img class="w-[70%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/upload_dummy_documents-2cb62cd811c2da1bf3d301b98845c241.png"></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="finalize-setup-for-the-microsoft-365-environment">Finalize setup for the Microsoft 365 environment<a href="#finalize-setup-for-the-microsoft-365-environment" class="hash-link" aria-label="Direct link to Finalize setup for the Microsoft 365 environment" title="Direct link to Finalize setup for the Microsoft 365 environment">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-create-the-employees-onboarding-list">1. Create the employees onboarding list<a href="#1-create-the-employees-onboarding-list" class="hash-link" aria-label="Direct link to 1. Create the employees onboarding list" title="Direct link to 1. Create the employees onboarding list">​</a></h3>
<p>In the SharePoint site associated to this team, create a new SharePoint list <code>Employees Onboarding</code> with the following columns (<strong>internal names are important here as they will be referenced in the agent code</strong>):</p>
<table><thead><tr><th>Column internal name</th><th>Display name</th><th>Type</th></tr></thead><tbody><tr><td><code>contosoEmployeeName</code></td><td>Employee Name</td><td>Person or Group</td></tr><tr><td><code>contosoEmployeeStartDate</code></td><td>Employee Start Date</td><td>Date</td></tr><tr><td><code>contosoEmployeePlanId</code></td><td>Employee Plan ID</td><td>Text</td></tr><tr><td><code>contosoEmployeedAadObjectId</code></td><td>Employee AAD ID</td><td>Text</td></tr></tbody></table>
<p><img decoding="async" loading="lazy" alt="&amp;quot;Employee Onboarding list&amp;quot;" src="/m365-ai-agents-hackathon-onboard_D/assets/images/employee_splist_columns-3f9e14294737be8a086cbdbbc8299233.png" width="1836" height="595" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>In SharePoint, column internal names are set at column creation. Once set, you are free to rename the column with a friendly name</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-create-a-hr-onboarding-template-plan">2. Create a HR Onboarding template plan<a href="#2-create-a-hr-onboarding-template-plan" class="hash-link" aria-label="Direct link to 2. Create a HR Onboarding template plan" title="Direct link to 2. Create a HR Onboarding template plan">​</a></h3>
<p>Use the <code>deploy/import-tasks.ps1</code> script to automatically import a sample Microsoft Planner onboarding plan in the Microsoft 365 group:</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Install-Module Microsoft.Graph.Planner -Scope CurrentUser -Repository PSGallery -Force          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ClientId=&quot;{Client ID of the Entra ID app}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$TenantId=&quot;{Tenant ID}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ClientSecret=&quot;{Client Secret of the Entra ID app}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$GroupId=&quot;{ID if the Microsoft 365 group}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.\import-tasks1.ps1 -clientID $ClientId -tenantID $TenantId -clientSecret $ClientSecret -csvfilepath &quot;./data/tasks.csv&quot; -PlanName &quot;Contoso Employee Onboarding Plan&quot; -GroupID $GroupId</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><ul>
<li>You should be owner of the group to run that command.</li>
<li>Use the information from the Entra ID application created earlier (<code>ClientId</code>,<code>ClientSecret</code>,<code>TenantId</code>)</li>
<li>You can get tehh group ID by search the group name in Entra ID:
<img decoding="async" loading="lazy" alt="&amp;quot;Group ID&amp;quot;" src="/m365-ai-agents-hackathon-onboard_D/assets/images/group_id-604223d7f99d8b5daf58eeb048c56ff2.png" width="1502" height="571" class="img_ev3q"></li>
</ul></div></div>
<p>After the script completed, you can then add the plan to the team as a new tab:</p>
<div class="flex flex-col space-y-4 items-center justify-center"><img class="w-[50%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/add_plan_to_team-e180de4c2426565e1075b1104817c1b2.png"><img class="w-[80%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/sample_hr_plan-a1469e0503bddf33d6e919ec122bd306.png"></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-import-power-automate-flows">3. Import Power Automate flows<a href="#3-import-power-automate-flows" class="hash-link" aria-label="Direct link to 3. Import Power Automate flows" title="Direct link to 3. Import Power Automate flows">​</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>For the purpose of this solution, and to make the deployment easier, we used Power uatomate with Premium connectors (i.e. HTTP).</p></div></div>
<p>The Power Automate flow for new employee configuration is deployed as a Power Platform solution.</p>
<ol>
<li>Go to <a href="https://make.powerautomate.com/" target="_blank" rel="noopener noreferrer">https://make.powerautomate.com/</a>, choose the environment you want to use and then go to &#x27;Solutions&#x27;.</li>
<li>Import the <code>deploy/onboard_dNewEmployeeSetup.zip</code> solution file and click &#x27;Next&#x27; (let <em>&#x27;Enable Plugin steps and flows included in the solution&#x27;</em> option enabled).</li>
<li>Select <em>&quot;Review and adjust all connections&quot;</em> and configure connections according to your environment (SharePoint, Planner and Office 365).</li>
<li>Fill the workflow paramaters according to your environment:</li>
</ol>
<p><img decoding="async" loading="lazy" alt="&amp;quot;Power Automate paramters&amp;quot;" src="/m365-ai-agents-hackathon-onboard_D/assets/images/power_automate_parameters-0aca1fbd32d455b720b88ac85649a628.png" width="1033" height="1054" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The Plan ID can be rereived directly from the URL when, from teh Team tab you select <em>&quot;Open in new window&quot;</em>:
<img decoding="async" loading="lazy" alt="&amp;quot;Planner ID&amp;quot;" src="/m365-ai-agents-hackathon-onboard_D/assets/images/planner_id_url-07458d31eff839bb2ca2d0c6099327ab.png" width="1214" height="51" class="img_ev3q">
Leave the <em>&#x27;Notifications endpoint&#x27;</em> parameter untouched for now. This URL will be replaced by a DevTunnels temporary URL when testing the agent.</p></div></div>
<ol start="5">
<li>Test the Power Automate by adding a new entry in the list for your account (employee name + start date, leave other fields blank). You should see the plan ID and AAD ID values populated automatically by the flow.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="&amp;quot;Power Automate results&amp;quot;" src="/m365-ai-agents-hackathon-onboard_D/assets/images/power_automate_outcome-7e458e1568517867e9c5f62407510d63.png" width="1538" height="218" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-link-documents-to-task">4. Link documents to task<a href="#4-link-documents-to-task" class="hash-link" aria-label="Direct link to 4. Link documents to task" title="Direct link to 4. Link documents to task">​</a></h3>
<p>To test the cross references retrieval from the agent using mutliple tools, you can link specific documents to a task. This way, the content of these documents will be considered when providing a summay of task to the user.</p>
<ul>
<li>In Microsoft Planner. go to the plan newly created for the user and link the <em>Contoso Electronics PerksPlus Program.docx</em> file to the &#x27;Review company policies&#x27; task:</li>
</ul>
<div class="flex justify-center"><img class="w-[70%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/add_references_to_task-6d3686264bdb02bd60222da5b80b3ef8.png"></div>
<br>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>To get the absolute path of a file in a SharePoint library, select the document item, open the &#x27;Details&#x27; pane and copy the value:</p><div class="flex justify-center"><img class="w-[40%]" src="/m365-ai-agents-hackathon-onboard_D/assets/images/copy_file_path-f533b52f144dc748b3ca83715b8092ad.png"></div></div></div>
<p>You are now ready to <a href="/m365-ai-agents-hackathon-onboard_D/agent-testing">test the agent locally from Visual Studio Code and Teams Toolkit</a>!cd</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/FranckyC/m365-ai-agents-hackathon-onboard_D/docs/2-setup-environment.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-04-29T16:27:00.000Z" itemprop="dateModified">Apr 29, 2025</time></b> by <b>Franck Cornu</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/m365-ai-agents-hackathon-onboard_D/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Meet Onboard_D, your HR onboading coach!</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/m365-ai-agents-hackathon-onboard_D/agent-testing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Minimal path to awesome</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#clone-the-github-repository" class="table-of-contents__link toc-highlight">Clone the GitHub repository</a></li><li><a href="#create-a-new-team-in-teams" class="table-of-contents__link toc-highlight">Create a new team in Teams</a></li><li><a href="#setup-azure-environment" class="table-of-contents__link toc-highlight">Setup Azure environment</a><ul><li><a href="#1-create-a-new-entra-id-application" class="table-of-contents__link toc-highlight">1. Create a new Entra ID application</a></li><li><a href="#2-create-azure-resources" class="table-of-contents__link toc-highlight">2. Create Azure resources</a><ul><li><a href="#create-a-new-resource-group" class="table-of-contents__link toc-highlight">Create a new resource group</a></li><li><a href="#create-a-new-azure-openai-resource" class="table-of-contents__link toc-highlight">Create a new Azure OpenAI resource</a></li><li><a href="#create-a-new-storage-account" class="table-of-contents__link toc-highlight">Create a new storage account</a></li><li><a href="#create-azure-ai-search" class="table-of-contents__link toc-highlight">Create Azure AI Search</a></li><li><a href="#create-the-logic-app-to-index-documents" class="table-of-contents__link toc-highlight">Create the Logic App to index documents</a></li></ul></li></ul></li><li><a href="#finalize-setup-for-the-microsoft-365-environment" class="table-of-contents__link toc-highlight">Finalize setup for the Microsoft 365 environment</a><ul><li><a href="#1-create-the-employees-onboarding-list" class="table-of-contents__link toc-highlight">1. Create the employees onboarding list</a></li><li><a href="#2-create-a-hr-onboarding-template-plan" class="table-of-contents__link toc-highlight">2. Create a HR Onboarding template plan</a></li><li><a href="#3-import-power-automate-flows" class="table-of-contents__link toc-highlight">3. Import Power Automate flows</a></li><li><a href="#4-link-documents-to-task" class="table-of-contents__link toc-highlight">4. Link documents to task</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025</div></div></div></footer></div>
</body>
</html>